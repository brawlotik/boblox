local plr = game.Players.LocalPlayer
local chr = plr.Character
local pos = destination() or partfind()
local car = workspace.Vehicles[plr.Name]

if car and pos then
    local dist = (car.WorldPivot.Position - pos.Position).magnitude

    -- Если расстояние меньше 100, запускаем твин
    if dist < 100 then
        local TweenService = game:GetService("TweenService")
        local tweenInfo = TweenInfo.new(
            5, -- Длительность анимации (в секундах)
            Enum.EasingStyle.Linear, -- Стиль анимации
            Enum.EasingDirection.InOut, -- Направление анимации
            0, -- Количество повторений
            false, -- Обратная анимация
            0 -- Задержка перед началом
        )

        -- Создаем твин для перемещения машины
        local tween = TweenService:Create(car, tweenInfo, { CFrame = pos.CFrame })
        tween:Play() -- Запускаем твин

        -- Ожидаем завершения твина
        tween.Completed:Wait()

        -- Восстанавливаем гравитацию
        workspace.Gravity = 196

        -- Перемещаем машину к автобусным остановкам
        for _, v in pairs(workspace.BusStops:GetDescendants()) do
            if v.Name == "SelectionBox" and v.Visible then
                car:PivotTo(v.Parent.CFrame + Vector3.new(0, 5, 0))
            end
        end

        -- Ожидаем, пока игрок не отдалится от целевой позиции
        local startTime = tick()
        repeat
            task.wait()
        until partfind() == nil or (plr:DistanceFromCharacter(pos.Position) > 70) or (tick() - startTime >= 5)
    end
end
